---
globs: **/components/**/*.tsx, **/pages/**/*.tsx
exclude: **/__tests__/**, **/*.test.*, **/*.spec.*
alwaysApply: false
---

# Music Be Simple Component Development Standards

## File Organization

```
src/components/
â”œâ”€â”€ buttons/
â”‚   â”œâ”€â”€ TopButton.tsx
â”‚   â””â”€â”€ UseFlatsButton.tsx
â”œâ”€â”€ displays/
â”‚   â”œâ”€â”€ Displays.tsx
â”‚   â”œâ”€â”€ DisplaySelector.tsx
â”‚   â”œâ”€â”€ DisplaysSelector.tsx
â”‚   â”œâ”€â”€ Modes.tsx
â”‚   â””â”€â”€ instruments/
â”‚       â”œâ”€â”€ Instrument.tsx
â”‚       â”œâ”€â”€ Guitar.tsx
â”‚       â”œâ”€â”€ Piano.tsx
â”‚       â”œâ”€â”€ Banjo.tsx
â”‚       â”œâ”€â”€ Mandolin.tsx
â”‚       â””â”€â”€ Ukulele.tsx
â”œâ”€â”€ nav/
â”‚   â”œâ”€â”€ Navbar.tsx
â”‚   â””â”€â”€ NavTab.tsx
â”œâ”€â”€ Footer.tsx
â”œâ”€â”€ Icon.tsx
â”œâ”€â”€ Main.tsx
â””â”€â”€ Title.tsx

src/pages/
â”œâ”€â”€ Chords/
â”‚   â””â”€â”€ index.tsx
â”œâ”€â”€ Play/
â”‚   â””â”€â”€ index.tsx
â””â”€â”€ Scales/
    â””â”€â”€ index.tsx

src/routes/
â”œâ”€â”€ __root.tsx
â”œâ”€â”€ index.tsx
â”œâ”€â”€ chords.tsx
â”œâ”€â”€ play.tsx
â””â”€â”€ scales.tsx
```

## Component Structure Guidelines

### Avoid Superfluous Wrappers

- **Remove unnecessary wrapper divs**: Don't create wrapper divs that add DOM complexity without benefit
- **Simplify component structure**: Remove redundant nesting when possible
- **Keep meaningful wrappers**: Retain wrappers that serve styling, semantic, or organizational purposes

### Spacing Guidelines

- **Avoid `space-*` utilities**: Don't use `space-x-*` or `space-y-*` utilities - they rely on margin-based spacing
- **Use flex/gap spacing**: Use `flex flex-col gap-*` for vertical spacing and `flex items-center gap-*` for horizontal spacing
- **Maintain visual consistency**: All spacing changes should preserve the original visual appearance

#### Spacing Examples

```tsx
// âŒ Avoid - margin-based spacing
<div className='space-y-4'>
  <Component />
</div>

// âœ… Good - flexbox-based spacing
<div className='flex flex-col gap-4'>
  <Component />
</div>
```

```tsx
// âŒ Avoid - redundant wrapper
<div className='Container'>
  <div className='flex flex-col gap-4'>
    <Component />
  </div>
</div>

// âœ… Good - simplified structure
<div className='Container flex flex-col gap-4'>
  <Component />
</div>
```

## Utility Components

Always use the project's utility components instead of creating custom HTML elements when possible:

### Core UI Components

- **Main** (`@/components/Main`) - Main content wrapper component with page-specific styling
  - Required props: `componentName` (string), `children` (ReactNode)
  - Applies page-specific background color based on componentName
  - Provides consistent layout structure

- **Navbar** (`@/components/Navbar`) - Navigation bar component
  - Renders navigation tabs for Scales, Chords, and Play
  - Uses NavTab components for individual tabs

- **NavTab** (`@/components/NavTab`) - Navigation tab component
  - Required props: `title` (TabType), `to` (string)
  - Uses TanStack Router Link for navigation
  - Supports active state styling

- **TopButton** (`@/components/TopButton`) - Top button component
  - Required props: `title` (string), `icon` (string), `position` ('left' | 'right'), `onFxn` (() => void)
  - Positioned absolutely at top corners
  - Uses emoji icons for visual indicators

#### Example Usage

```tsx
// âœ… Use Main component wrapper
import Main from '@/components/Main';
import Title from '@/components/Title';

export default function Chords() {
  return (
    <Main componentName='Chords'>
      <Title title='Chords' />
    </Main>
  );
}

// âœ… Use TopButton component
import TopButton from '@/components/buttons/TopButton';

<TopButton
  title='Chords'
  icon='ğŸ“–'
  position='left'
  onFxn={() => {}}
/>

// âŒ Don't create custom wrapper when utility exists
<div className='custom-wrapper'>
  <h1>Chords</h1>
</div>
```

## Component Guidelines

### Single-Purpose Components

- **One component per file**: Each file contains exactly one React component
- **Bite-sized components**: Components should be focused and single-purpose (one thing == one component == one file)
- **Descriptive naming**: Use PascalCase with descriptive names indicating visual purpose
- **Component suffixes**: Use appropriate suffixes when needed (e.g., `Container`, `Panel`, `Button`, `Display`)

### Component Structure

```tsx
// Pattern 1: Default export function component (most common)
import type { ReactNode } from 'react';

import Main from '@/components/Main';

type ComponentProps = {
	title: string;
	variant?: 'primary' | 'secondary';
	children?: ReactNode;
};

export default function ComponentName({
	title,
	variant = 'primary',
	children,
}: ComponentProps) {
	return (
		<Main componentName={title}>
			{children}
		</Main>
	);
}

// Pattern 2: forwardRef component with default export (for DOM refs)
import { forwardRef } from 'react';

const ComponentName = forwardRef<HTMLDivElement, ComponentProps>(
	({ title, variant = 'primary', children }, ref) => {
		return (
			<div
				ref={ref}
				className='ComponentName base-classes'
			>
				{children}
			</div>
		);
	},
);

ComponentName.displayName = 'ComponentName';

export default ComponentName;

// Pattern 3: Memoized component (for performance optimization)
import { memo } from 'react';

function ComponentName({ title, variant = 'primary', children }: ComponentProps) {
	return (
		<div className='ComponentName base-classes'>
			{children}
		</div>
	);
}

export default memo(ComponentName);
```

### Component Guidelines

- **TypeScript types**: Prefer `type` over `interface` for component props and data structures
- **Default exports**: Export components as default exports using `export default function ComponentName`
- **Import paths**: Use `@/` path alias for imports (configured in tsconfig.json)
- **Import order**: Type imports come before value imports (e.g., `import type { ReactNode } from 'react'` before `import { useState } from 'react'`)
- **Props interface**: Define clear, typed props with descriptive names
- **forwardRef usage**: Use `forwardRef` for components that need to expose DOM refs
- **Memoization**: Use `memo` for components with stable props to prevent unnecessary re-renders

## Component Patterns

### Layout Components

- **Main** (`@/components/Main`) - Main content wrapper component with page-specific styling
- **Navbar** (`@/components/nav/Navbar`) - Navigation bar with tabs for Scales, Chords, and Play
- **NavTab** (`@/components/nav/NavTab`) - Individual navigation tab component
- **Footer** (`@/components/Footer`) - Footer component with copyright information
- **Title** (`@/components/Title`) - Title component for page headings

### Button Components

- **TopButton** (`@/components/buttons/TopButton`) - Top button component for page-specific actions
- **UseFlatsButton** (`@/components/buttons/UseFlatsButton`) - Button to toggle between flats and sharps

### Display Components

- **Displays** (`@/components/displays/Displays`) - Container for instrument displays
- **DisplaysSelector** (`@/components/displays/DisplaysSelector`) - Selector for choosing displays
- **DisplaySelector** (`@/components/displays/DisplaySelector`) - Individual display selector
- **Modes** (`@/components/displays/Modes`) - Modes display component
- **Instrument** (`@/components/displays/instruments/Instrument`) - Base instrument display component
- **Guitar, Piano, Banjo, Mandolin, Ukulele** - Specific instrument display components

### Page Components

All page components follow a similar pattern:

- **Chords** (`@/pages/Chords`) - Chords page for chord-related functionality (default export)
- **Scales** (`@/pages/Scales`) - Scales page for scale-related functionality (default export)
- **Play** (`@/pages/Play`) - Play page for music playback functionality (default export)

## State Management

The project uses React Context API for state management with custom hooks:

### Context Providers

- **GlobalsContext** (`@/context/Globals`) - Global application state
- **ScalesContext** (`@/context/Scales`) - Scales-specific state
- **ChordsContext** (`@/context/Chords`) - Chords-specific state
- **PlayContext** (`@/context/Play`) - Play functionality state

### Custom Hooks

- **useGlobals** (`@/hooks/useGlobals`) - Access global context
- **useScales** (`@/hooks/useScales`) - Access scales context
- **useChords** (`@/hooks/useChords`) - Access chords context
- **usePlay** (`@/hooks/usePlay`) - Access play context

### Using State

```tsx
import Main from '@/components/Main';
import { useScales } from '@/hooks/useScales';
import { useGlobals } from '@/hooks/useGlobals';

export default function Scales() {
  const { tonic, variant, notes, handleTonicChange } = useScales();
  const { displays, usingFlats } = useGlobals();
  
  return (
    <Main componentName='Scales'>
      {/* Use state */}
    </Main>
  );
}
```

### Context Provider Pattern

Context providers wrap page components at the route level:

```tsx
// Route file (src/routes/scales.tsx)
import { ScalesContextProvider } from '@/context';
import Scales from '@/pages/Scales';

function ScalesPage() {
  return (
    <ScalesContextProvider>
      <Scales />
    </ScalesContextProvider>
  );
}
```

## Component Best Practices

### Performance

- **React.memo**: Use for components with stable props when needed
- **useMemo**: Use for expensive computations
- **useCallback**: Use for event handlers passed as props
- **Lazy loading**: Use `lazy()` and `Suspense` for code splitting page components if needed
- **Tree shaking**: Import only necessary components
- **Context hooks**: Use context hooks to access state efficiently

### Accessibility

- **ARIA labels**: Include appropriate ARIA labels and roles
- **Keyboard navigation**: Support keyboard navigation for interactive elements
- **Focus management**: Implement proper focus management
- **Screen reader compatibility**: Ensure screen reader compatibility
- **Color contrast**: Maintain proper color contrast ratios
- **Semantic HTML**: Use semantic HTML structure (header, main, footer, nav, section, etc.)
- **Image alt text**: Always provide descriptive alt text for images
- **Link titles**: Include descriptive title attributes for links

### Error Handling

- **Defensive programming**: Include validation and fallbacks for data integrity
- **Graceful degradation**: Handle missing data values gracefully
- **Null checks**: Check for null/undefined values before rendering

### Icons

- **Emoji icons**: Use emoji icons for simple visual indicators (e.g., 'ğŸ“–' for TopButton)
- **Icon accessibility**: Include appropriate title attributes for icon buttons
- **Icon sizing**: Icons are sized via className on button elements

## Styling Guidelines

### Tailwind CSS

- **Utility-first**: Use Tailwind utility classes for styling
- **Custom classes**: Use custom CSS classes for complex or reusable patterns
- **Responsive design**: Use Tailwind responsive prefixes (sm:, md:, lg:, xl:)
- **Dark mode**: Support dark mode if configured in Tailwind config

### Class Management

- **clsx**: Use `clsx` for conditional class names
- **Component classes**: Include component name as base class for scoping

```tsx
import clsx from 'clsx';

<div
  className={clsx(
    'ComponentName base-classes',
    condition && 'conditional-classes',
    variant === 'primary' && 'primary-classes',
  )}
>
```

## Typography

- **Typographic apostrophe**: Use ' instead of ' in all user-facing text
- **System fonts**: Uses Inter font family (defined in globals.css)
- **Responsive typography**: Use responsive text size utilities (text-2xl, text-3xl, etc.)

## Routing

- **TanStack Router**: Use TanStack Router for navigation
- **Link component**: Use Link component from `@tanstack/react-router` for navigation
- **Active state**: Use `activeProps` prop on Link for active state styling
- **Route structure**: Routes are defined in `src/routes/` directory

```tsx
import { Link } from '@tanstack/react-router';

<Link
  to='/chords'
  className='px-4 py-2 rounded-t-lg hover:bg-gray-100 transition-colors'
  activeProps={{ className: 'bg-gray-300 font-bold' }}
  title='Chords'
>
  Chords
</Link>
```

## Component Testing

### Unit Testing

- **Component rendering**: Test component rendering with different props
- **User interactions**: Test user interactions and callbacks
- **Accessibility features**: Test accessibility features
- **Data integration**: Test components with different data values

### Integration Testing

- **Page integration**: Test page components within routes
- **Navigation behavior**: Test navigation between pages
- **Responsive behavior**: Test responsive behavior across screen sizes
- **State persistence**: Test context state persistence across page navigation

### Testing Commands

- Use `bun dev` for development server
- Use `bun run build` for production build
- Use `bun lint` for linting
- Use `bun format` for formatting code
- Use `bun preview` for previewing production build
